(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{341:function(s,a,t){"use strict";t.r(a);var e=t(3),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/chst365/bolgImgs/imgs/topImgs/252.jpg",alt:""}})]),s._v(" "),a("h1",{attrs:{id:"三、基础篇-webpack-进阶用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、基础篇-webpack-进阶用法"}},[s._v("#")]),s._v(" 三、基础篇：webpack 进阶用法")]),s._v(" "),a("h2",{attrs:{id:"_1-自动清理构建目标产物"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-自动清理构建目标产物"}},[s._v("#")]),s._v(" 1. 自动清理构建目标产物")]),s._v(" "),a("h3",{attrs:{id:"当前构建时的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#当前构建时的问题"}},[s._v("#")]),s._v(" 当前构建时的问题")]),s._v(" "),a("p",[s._v("每次构建的时候不会清理目录，造成构建的输出目录 output 文件越来越多")]),s._v(" "),a("h3",{attrs:{id:"通过-npm-scripts-清理构建目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过-npm-scripts-清理构建目录"}},[s._v("#")]),s._v(" 通过 npm scripts 清理构建目录")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rm -rf ./dist && webpack\nrimraf ./dist && webpack\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"自动清理构建目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动清理构建目录"}},[s._v("#")]),s._v(" 自动清理构建目录")]),s._v(" "),a("p",[s._v("避免构建前每次都需要手动删除 dist")]),s._v(" "),a("p",[s._v("使用 clean-webpack-plugin * 默认会删除 output 指定的输出目录")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    entry: {\n        app: './src/app.js',\n        search: './src/search.js'\n    },\n    output: {\n        filename: '[name][chunkhash:8].js',\n        path: __dirname + '/dist'\n    },\n    plugins: [\n        new CleanWebpackPlugin({})\n    ]\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h2",{attrs:{id:"_2-postcss-插件-autoprefixer-自动补齐-css3-前缀"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-postcss-插件-autoprefixer-自动补齐-css3-前缀"}},[s._v("#")]),s._v(" 2. PostCSS 插件 autoprefixer 自动补齐 CSS3 前缀")]),s._v(" "),a("h3",{attrs:{id:"css3-的属性为什么需要前缀"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css3-的属性为什么需要前缀"}},[s._v("#")]),s._v(" CSS3 的属性为什么需要前缀")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338300%2015911113556100%20.jpg",alt:"-w1452"}})]),s._v(" "),a("h3",{attrs:{id:"postcss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#postcss"}},[s._v("#")]),s._v(" PostCSS")]),s._v(" "),a("p",[s._v("使用 autoprefixer 插件\n根据 Can I Use 规则（"),a("a",{attrs:{href:"https://caniuse.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://caniuse.com/"),a("OutboundLink")],1),s._v("）")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    module: {\n        rules: [\n            {\n                test: /\\.less$/,\n                use: [\n                    'style-loader',\n                    'css-loader',\n                    'less-loader',\n                    {\n                        loader: 'postcss-loader',\n                        options: {\n                            plugins: () => [\n                                require('autoprefixer')({\n                                browsers: [\"last 2 version\", \">1%\",\"iOS 7\"]\n                                })\n                            ]\n                        }\n                    }\n                ]\n            }\n        ]\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h2",{attrs:{id:"_3-移动端-css-px-自动转换成-rem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-移动端-css-px-自动转换成-rem"}},[s._v("#")]),s._v(" 3. 移动端 CSS px 自动转换成 rem")]),s._v(" "),a("h3",{attrs:{id:"浏览器的分辨率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的分辨率"}},[s._v("#")]),s._v(" 浏览器的分辨率")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338313%2015915420734573%20.jpg",alt:"-w1202"}})]),s._v(" "),a("h3",{attrs:{id:"css-媒体查询实现响应式布局"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css-媒体查询实现响应式布局"}},[s._v("#")]),s._v(" CSS 媒体查询实现响应式布局")]),s._v(" "),a("p",[s._v("缺陷：需要写多套适配样式代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("@media screen and (max-width: 980px) {\n    .header {\n        width: 900px;\n    }\n}\n@media screen and (max-width: 480px) {\n    .header {\n        height: 400px;\n    }\n}\n@media screen and (max-width: 480px) {\n    .header {\n        height: 300px;\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h3",{attrs:{id:"rem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rem"}},[s._v("#")]),s._v(" rem")]),s._v(" "),a("p",[s._v("W3C 对 rem 的定义：font-size of the root element\nrem 和 px 的对比：\n_ rem 是相对单位\n_ px 是绝对单位")]),s._v(" "),a("h3",{attrs:{id:"移动端-css-px-自动转换成-rem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#移动端-css-px-自动转换成-rem"}},[s._v("#")]),s._v(" 移动端 CSS px 自动转换成 rem")]),s._v(" "),a("h4",{attrs:{id:"使用-px2rem-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-px2rem-loader"}},[s._v("#")]),s._v(" 使用 px2rem-loader")]),s._v(" "),a("h4",{attrs:{id:"页面渲染时计算根元素的-font-size-值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#页面渲染时计算根元素的-font-size-值"}},[s._v("#")]),s._v(" 页面渲染时计算根元素的 font-size 值")]),s._v(" "),a("ul",[a("li",[s._v("可以使用手淘的 lib-flexible 库")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/amfe/lib-flexible",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/amfe/lib-flexible"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    module: {\n        rules: [\n            {\n                test: /\\.less$/,\n                use: [\n                    'style-loader',\n                    'css-loader',\n                    'less-loader',\n                    {\n                        loader: 'px2rem-loader',\n                        options: {\n                            remUnit: 75,\n                            remPrecision: 8\n                        }\n                    }\n                ]\n            }\n        ]\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h2",{attrs:{id:"_4-静态资源内联"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-静态资源内联"}},[s._v("#")]),s._v(" 4. 静态资源内联")]),s._v(" "),a("h3",{attrs:{id:"_4-1-资源内联的意义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-资源内联的意义"}},[s._v("#")]),s._v(" 4.1 资源内联的意义")]),s._v(" "),a("h4",{attrs:{id:"代码层面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码层面"}},[s._v("#")]),s._v(" 代码层面：")]),s._v(" "),a("ul",[a("li",[s._v("页面框架的初始化脚本")]),s._v(" "),a("li",[s._v("上报相关打点")]),s._v(" "),a("li",[s._v("css 内联避免页面闪动")])]),s._v(" "),a("h4",{attrs:{id:"请求层面-减少-http-网络请求数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求层面-减少-http-网络请求数"}},[s._v("#")]),s._v(" 请求层面：减少 HTTP 网络请求数")]),s._v(" "),a("ul",[a("li",[s._v("小图片或者字体内联（url-loader）")])]),s._v(" "),a("h3",{attrs:{id:"_4-2-html-和-js-内联"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-html-和-js-内联"}},[s._v("#")]),s._v(" 4.2 HTML 和 JS 内联")]),s._v(" "),a("h4",{attrs:{id:"raw-loader-内联-html"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#raw-loader-内联-html"}},[s._v("#")]),s._v(" raw-loader 内联 html")]),s._v(" "),a("p",[a("code",[s._v("<script>${require('raw-loader!babel-loader!./meta.html')}<\/script>")])]),s._v(" "),a("h4",{attrs:{id:"raw-loader-内联-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#raw-loader-内联-js"}},[s._v("#")]),s._v(" raw-loader 内联 JS")]),s._v(" "),a("p",[a("code",[s._v("<script>${require('raw-loader!babel-loader!../node_modules/lib-flexible')}<\/script>")])]),s._v(" "),a("h3",{attrs:{id:"_4-3-css-内联"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-css-内联"}},[s._v("#")]),s._v(" 4.3 CSS 内联")]),s._v(" "),a("h4",{attrs:{id:"方案一-借助-style-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案一-借助-style-loader"}},[s._v("#")]),s._v(" 方案一：借助 style-loader")]),s._v(" "),a("h4",{attrs:{id:"方案二-html-inline-css-webpack-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案二-html-inline-css-webpack-plugin"}},[s._v("#")]),s._v(" 方案二：html-inline-css-webpack-plugin")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    module: {\n        rules: [\n            {\n                test: /\\.scss$/,\n                use: [\n                    {\n                        loader: 'style-loader',\n                        options: {\n                            insertAt: 'top',        // 样式插入到 <head>\n                            singleton: true,        // 将所有的style标签合并成一个\n                        }\n                    },\n                    'css-loader',\n                    'sass-loader'\n                ]\n            }\n        ]\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h2",{attrs:{id:"_5-多页面应用打包通用方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-多页面应用打包通用方案"}},[s._v("#")]),s._v(" 5. 多页面应用打包通用方案")]),s._v(" "),a("h3",{attrs:{id:"多页面应用-mpa-概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多页面应用-mpa-概念"}},[s._v("#")]),s._v(" 多页面应用（MPA）概念")]),s._v(" "),a("p",[s._v("每一次页面跳转的时候，后台服务器都会给返回一个新的 html 文档，这种类型的网站也就是多页面网站，也叫多页面应用。")]),s._v(" "),a("h3",{attrs:{id:"多页面打包基本思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多页面打包基本思路"}},[s._v("#")]),s._v(" 多页面打包基本思路")]),s._v(" "),a("h4",{attrs:{id:"方案一-每个页面对应一个-entry-一个-html-webpack-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案一-每个页面对应一个-entry-一个-html-webpack-plugin"}},[s._v("#")]),s._v(" 方案一：每个页面对应一个 entry,一个 html-webpack-plugin")]),s._v(" "),a("h4",{attrs:{id:"缺点-每次新增或删除页面需要改-webpack-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缺点-每次新增或删除页面需要改-webpack-配置"}},[s._v("#")]),s._v(" 缺点：每次新增或删除页面需要改 webpack 配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    entry: {\n        index: './src/index.js',\n        search: './src/search.js'\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"方案二-动态获取-entry-和设置-html-webpack-plugin-数量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案二-动态获取-entry-和设置-html-webpack-plugin-数量"}},[s._v("#")]),s._v(" 方案二: 动态获取 entry 和设置 html-webpack-plugin 数量")]),s._v(" "),a("h4",{attrs:{id:"利用-glob-sync"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#利用-glob-sync"}},[s._v("#")]),s._v(" 利用 glob.sync")]),s._v(" "),a("ul",[a("li",[s._v("entry: glob.sync(path.join(__dirname, './src/*/index.js'))")])]),s._v(" "),a("h2",{attrs:{id:"_6-使用-sourcemap"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-使用-sourcemap"}},[s._v("#")]),s._v(" 6. 使用 sourcemap")]),s._v(" "),a("h3",{attrs:{id:"使用-source-map"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-source-map"}},[s._v("#")]),s._v(" 使用 source map")]),s._v(" "),a("h4",{attrs:{id:"作用-通过-source-map-定位到源代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作用-通过-source-map-定位到源代码"}},[s._v("#")]),s._v(" 作用：通过 source map 定位到源代码")]),s._v(" "),a("ul",[a("li",[s._v("source map 科普文："),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html"),a("OutboundLink")],1)])]),s._v(" "),a("h4",{attrs:{id:"开发环境开启-线上环境关闭"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发环境开启-线上环境关闭"}},[s._v("#")]),s._v(" 开发环境开启，线上环境关闭")]),s._v(" "),a("ul",[a("li",[s._v("线上排除问题的时候可以将 sourcemap 上传到错误监控系统")])]),s._v(" "),a("h3",{attrs:{id:"source-map-关键字"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#source-map-关键字"}},[s._v("#")]),s._v(" source map 关键字")]),s._v(" "),a("ul",[a("li",[s._v("eval: 使用 eval 包裹模块代码")]),s._v(" "),a("li",[s._v("source map: 产生.map 文件")]),s._v(" "),a("li",[s._v("cheap: 不包含列信息")]),s._v(" "),a("li",[s._v("inline: 将 .map 作为 DataURI 嵌入，不单独生成 .map 文件")]),s._v(" "),a("li",[s._v("module: 包含 loader 的 sourcemap")])]),s._v(" "),a("h3",{attrs:{id:"source-map-类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#source-map-类型"}},[s._v("#")]),s._v(" source map 类型")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338326%2015917134505654%20.jpg",alt:"-w754"}})]),s._v(" "),a("h2",{attrs:{id:"_7-提取页面公共资源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-提取页面公共资源"}},[s._v("#")]),s._v(" 7. 提取页面公共资源")]),s._v(" "),a("h3",{attrs:{id:"基础库分离"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础库分离"}},[s._v("#")]),s._v(" 基础库分离")]),s._v(" "),a("ul",[a("li",[s._v("思路： 将 react、react-dom 基础包通过 cdn 引入，不打入 bundle 中")]),s._v(" "),a("li",[s._v("方法： 使用 html-webpack-externals-plugin\n"),a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338338%2015917144560217%20.jpg",alt:"-w700"}})])]),s._v(" "),a("h3",{attrs:{id:"利用-splitchunksplugin-进行公共脚本分离"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#利用-splitchunksplugin-进行公共脚本分离"}},[s._v("#")]),s._v(" 利用 SplitChunksPlugin 进行公共脚本分离")]),s._v(" "),a("p",[s._v("Webpack 4 内置的，替代 CommonsChunkPlugin 插件")]),s._v(" "),a("p",[s._v("chunks 参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("async 异步引入的库进行分离（默认）")]),s._v(" "),a("li",[s._v("initial 同步引入的库进行分离")]),s._v(" "),a("li",[s._v("all 所有引入的库进行分离（推荐）")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    optimization: {\n        splitChunks: {\n            chunks: 'async',\n            minSize: 30000,                             // 抽离公共包最小大小（字节）\n            maxSize: 0,                                 // 最大大小\n            minChunks: 3,                               // 公共代码出现的次数\n            maxAsyncRequests: 5,                        //\n            maxInitialRequests: 3,\n            automaticNameDelimiter: '~',\n            name: true,\n            cacheGroups: {\n                vendors: {\n                    test: /[\\\\/]node_modules[\\\\/]/,\n                    priority: -10\n                }\n            }\n        }\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"利用-splitchunksplugin-分离基础包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#利用-splitchunksplugin-分离基础包"}},[s._v("#")]),s._v(" 利用 SplitChunksPlugin 分离基础包")]),s._v(" "),a("h4",{attrs:{id:"test-匹配出需要分离的包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-匹配出需要分离的包"}},[s._v("#")]),s._v(" test: 匹配出需要分离的包")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    optimization: {\n        splitChunks: {\n            cacheGroups: {\n                commons: {\n                    test: /(react|react-dom)/,\n                    name: 'vendors',\n                    chunks: 'all'\n                }\n            }\n        }\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"利用-splitchunksplugin-分离页面公共文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#利用-splitchunksplugin-分离页面公共文件"}},[s._v("#")]),s._v(" 利用 SplitChunksPlugin 分离页面公共文件")]),s._v(" "),a("ul",[a("li",[s._v("minChunks: 设置最小引用次数为 2 次")]),s._v(" "),a("li",[s._v("minSize: 分离的包体积的大小")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    optimization: {\n        splitChunks: {\n            minSize: 0,\n            cacheGroups: {\n                commons: {\n                    name: 'vendors',\n                    chunks: 'all',\n                    minChunks: 2\n                }\n            }\n        }\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"_8-treeshaking-的使用和原理分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-treeshaking-的使用和原理分析"}},[s._v("#")]),s._v(" 8. treeshaking 的使用和原理分析")]),s._v(" "),a("h3",{attrs:{id:"tree-shaking-摇树优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking-摇树优化"}},[s._v("#")]),s._v(" tree shaking (摇树优化)")]),s._v(" "),a("p",[s._v("概念：一个模块可能有多个方法，只要其中的某个方法使用到了，则整个文件都会被打到 bundle 里面去，tree shaking 就是只把用到的方法打入 bundle，没用到的方法会在 uglify 阶段被擦出掉。\n使用：")]),s._v(" "),a("ul",[a("li",[s._v("webpack 默认支持，在 .babelrc 里设置 modules: false 即可")]),s._v(" "),a("li",[s._v("production mode 的情况下默认开启\n要求：必须是 ES6 的语法，CJS 的方式不支持")])]),s._v(" "),a("h3",{attrs:{id:"dce-elimination"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dce-elimination"}},[s._v("#")]),s._v(" DCE（Elimination）")]),s._v(" "),a("h4",{attrs:{id:"代码不会被执行-不可到达"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码不会被执行-不可到达"}},[s._v("#")]),s._v(" 代码不会被执行，不可到达")]),s._v(" "),a("h4",{attrs:{id:"代码执行的结果不会被用到"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码执行的结果不会被用到"}},[s._v("#")]),s._v(" 代码执行的结果不会被用到")]),s._v(" "),a("h4",{attrs:{id:"代码只会影响死变量-只写不读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码只会影响死变量-只写不读"}},[s._v("#")]),s._v(" 代码只会影响死变量（只写不读）")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("if(false) {\n    console.log('这段代码永远不会执行');\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"tree-shaking-原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking-原理"}},[s._v("#")]),s._v(" Tree-shaking 原理")]),s._v(" "),a("p",[s._v("利用 ES6 模块的特点：")]),s._v(" "),a("ul",[a("li",[s._v("只能作为模块顶层的语句出现")]),s._v(" "),a("li",[s._v("import 的模块名只能是字符串常量")]),s._v(" "),a("li",[s._v("import binding 是 immutable 的\n代码擦除：uglify 阶段删除无用代码")])]),s._v(" "),a("h2",{attrs:{id:"_9-scopehoisting-使用和原理分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-scopehoisting-使用和原理分析"}},[s._v("#")]),s._v(" 9. ScopeHoisting 使用和原理分析")]),s._v(" "),a("h3",{attrs:{id:"现象-构建后的代码存在大量闭包代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现象-构建后的代码存在大量闭包代码"}},[s._v("#")]),s._v(" 现象：构建后的代码存在大量闭包代码")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338351%2015920375653898%20.jpg",alt:"-w1115"}})]),s._v(" "),a("h3",{attrs:{id:"会导致什么问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#会导致什么问题"}},[s._v("#")]),s._v(" 会导致什么问题？")]),s._v(" "),a("ul",[a("li",[s._v("大量函数闭包包裹代码，导致体积增大（模块越多越明显）")]),s._v(" "),a("li",[s._v("运行代码时创建的函数作用域变多，内存开销变大")])]),s._v(" "),a("h3",{attrs:{id:"模块转换分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块转换分析"}},[s._v("#")]),s._v(" 模块转换分析")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338362%2015920384312103%20.jpg",alt:"-w1254"}})]),s._v(" "),a("p",[s._v("结论：")]),s._v(" "),a("ul",[a("li",[s._v("被 webpack 转换后的模块会带上一层包裹")]),s._v(" "),a("li",[s._v("import 会被转换成 __webpack_require")])]),s._v(" "),a("h3",{attrs:{id:"进一步分析-webpack-的模块机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进一步分析-webpack-的模块机制"}},[s._v("#")]),s._v(" 进一步分析 webpack 的模块机制")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338376%2015920387012256%20.jpg",alt:"-w582"}})]),s._v(" "),a("p",[s._v("分析：")]),s._v(" "),a("ul",[a("li",[s._v("打包出来的是一个 IIFE（匿名闭包）")]),s._v(" "),a("li",[s._v("modules 是一个数组，每一项是一个模块初始化函数")]),s._v(" "),a("li",[s._v("__webpack_require 用来加载模块，返回 module.exports")]),s._v(" "),a("li",[s._v("通过 WEBPACK_REQUIRE_METHOD(0) 启动程序")])]),s._v(" "),a("h3",{attrs:{id:"scope-hoisting-原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scope-hoisting-原理"}},[s._v("#")]),s._v(" scope hoisting 原理")]),s._v(" "),a("p",[s._v("原理：将所有模块的代码按照引用顺序放在一个函数作用域里，然后适当的重命名一些变量以防止变量名冲突\n对比：通过 scope hoisting 可以减少函数声明代码和内存开销\n"),a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338389%2015920390682548%20.jpg",alt:"-w1099"}})]),s._v(" "),a("h3",{attrs:{id:"scope-hoisting-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scope-hoisting-使用"}},[s._v("#")]),s._v(" scope hoisting 使用")]),s._v(" "),a("p",[s._v("webpack mode 为 production 默认开启\n必须是 ES6 语法，CJS 不支持")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    entry: {\n        app: './src/app.js',\n        search: './src/search.js'\n    },\n    output: {\n        filename: '[name][chunkhash:8].js',\n        path: __dirname + '/dist'\n    },\n    plugins: [\n        new webpack.optimize.ModuleConcatenationPlugin()\n    ]\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h2",{attrs:{id:"_10-代码分割和动态-import"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-代码分割和动态-import"}},[s._v("#")]),s._v(" 10. 代码分割和动态 import")]),s._v(" "),a("h4",{attrs:{id:"代码分割的意义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码分割的意义"}},[s._v("#")]),s._v(" 代码分割的意义")]),s._v(" "),a("p",[s._v("对于大的 Web 应用来讲，将所有的代码都放在一个文件中显然是不够有效的，特别是当你的某些代码块是在某些特殊的时候才会被使用到。webpack 有一个功能就是讲你的代码库分割成 chunks （语块），当代码运行到需要他们的时候再进行加载")]),s._v(" "),a("h4",{attrs:{id:"适用的场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#适用的场景"}},[s._v("#")]),s._v(" 适用的场景")]),s._v(" "),a("ul",[a("li",[s._v("抽离相同代码到一个共享块")]),s._v(" "),a("li",[s._v("脚本懒加载，使得初始下载的代码更小\n"),a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338400%2015920403252153%20.jpg",alt:"-w468"}})])]),s._v(" "),a("h4",{attrs:{id:"懒加载-js-脚本的方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#懒加载-js-脚本的方式"}},[s._v("#")]),s._v(" 懒加载 JS 脚本的方式")]),s._v(" "),a("p",[s._v("CommonJS: require.ensure\nES6: 动态 import（目前还没有原生支持，需要 babel 支持）")]),s._v(" "),a("h4",{attrs:{id:"如何使用动态-import"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何使用动态-import"}},[s._v("#")]),s._v(" 如何使用动态 import?")]),s._v(" "),a("ul",[a("li",[s._v("安装 babel 插件\n"),a("ul",[a("li",[a("code",[s._v("npm install @babel/plugin-syntax-dynamic-import --save-dev")])])])]),s._v(" "),a("li",[s._v("ES6: 动态 import（目前还没有原生支持，需要 babel 支持）"),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n    "plugins": ["@babel/plugin-syntax-dynamic-import"],\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])]),s._v(" "),a("h4",{attrs:{id:"代码分割的效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码分割的效果"}},[s._v("#")]),s._v(" 代码分割的效果")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338412%2015921075491398%20.jpg",alt:"-w810"}})]),s._v(" "),a("h2",{attrs:{id:"_11-webpack-和-eslint-结合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-webpack-和-eslint-结合"}},[s._v("#")]),s._v(" 11. webpack 和 ESLint 结合")]),s._v(" "),a("h3",{attrs:{id:"eslint-的必要性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eslint-的必要性"}},[s._v("#")]),s._v(" ESLint 的必要性")]),s._v(" "),a("p",[s._v("2017 年年 4 ⽉月 13 ⽇日，腾讯⾼高级⼯工程师⼩小明在做充值业务时，修改了了苹果 iap ⽀支付配 置，将 JSON 配置增加了了重复的 key 。代码发布后，有⼩小部分使⽤用了了 vivo ⼿手 机的⽤用户反馈充值⻚页⾯面⽩白屏，⽆无法在 Now app 内进⾏行行充值。最后问题定位是: vivo ⼿手机使⽤用了了系统⾃自带的 webview ⽽而没有使⽤用 X5 内核，解析 JSON 时遇到 重复 key 报错，导致⻚页⾯面⽩白屏。")]),s._v(" "),a("h3",{attrs:{id:"行业里面优秀的-eslint-规范实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#行业里面优秀的-eslint-规范实践"}},[s._v("#")]),s._v(" 行业里面优秀的 ESLint 规范实践")]),s._v(" "),a("h4",{attrs:{id:"airbnb-eslint-config-airbnb、eslint-config-airbnb-base"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#airbnb-eslint-config-airbnb、eslint-config-airbnb-base"}},[s._v("#")]),s._v(" Airbnb: eslint-config-airbnb、eslint-config-airbnb-base")]),s._v(" "),a("h4",{attrs:{id:"腾讯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#腾讯"}},[s._v("#")]),s._v(" 腾讯：")]),s._v(" "),a("ul",[a("li",[s._v("alloyteem 团队 eslint-config-alloy "),a("a",{attrs:{href:"https://github.com/AlloyTeam/eslint-config-alloy",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/AlloyTeam/eslint-config-alloy"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("ivweb 团队：eslint-config-ivweb "),a("a",{attrs:{href:"https://github.com/feflow/eslint-config-ivweb",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/feflow/eslint-config-ivweb"),a("OutboundLink")],1)])]),s._v(" "),a("h3",{attrs:{id:"制定团队的-eslint-规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#制定团队的-eslint-规范"}},[s._v("#")]),s._v(" 制定团队的 ESLint 规范")]),s._v(" "),a("ul",[a("li",[s._v("不重复造轮子，基于 eslint:recommend 配置并改进")]),s._v(" "),a("li",[s._v("能够帮助发现代码错误的规则，全部开启")]),s._v(" "),a("li",[s._v("帮助保持团队的代码风格统一，而不是限制开发体验\n"),a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338424%2015921088225309%20.jpg",alt:"-w671"}})])]),s._v(" "),a("h3",{attrs:{id:"eslint-如何执行落地"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eslint-如何执行落地"}},[s._v("#")]),s._v(" ESLint 如何执行落地？")]),s._v(" "),a("ul",[a("li",[s._v("和 CI/CD 系统集成")]),s._v(" "),a("li",[s._v("和 webpack 集成")])]),s._v(" "),a("h4",{attrs:{id:"方案一-webpack-与-ci-cd-集成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案一-webpack-与-ci-cd-集成"}},[s._v("#")]),s._v(" 方案一：webpack 与 CI/CD 集成")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338435%2015921091532231%20.jpg",alt:"-w863"}})]),s._v(" "),a("h4",{attrs:{id:"本地开发阶段增加-precommit-钩子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地开发阶段增加-precommit-钩子"}},[s._v("#")]),s._v(" 本地开发阶段增加 precommit 钩子")]),s._v(" "),a("ul",[a("li",[s._v("安装 husky\n"),a("ul",[a("li",[a("code",[s._v("npm install husky --save-dev")])])])]),s._v(" "),a("li",[s._v("增加 npm script,通过 lint-staged 增量检查修改的文件")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('"scripts": {\n    "precommit": "lint-staged"\n},\n"lint-staged": {\n    "linters": {\n        "*.{js,scss}":["eslint--fix","git add"]\n    }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h4",{attrs:{id:"方案二-webpack-与-eslint-集成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案二-webpack-与-eslint-集成"}},[s._v("#")]),s._v(" 方案二：webpack 与 ESLint 集成")]),s._v(" "),a("p",[s._v("使用 eslint-loader,构建时检查 JS 规范")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('module.exports = {\n    module: {\n        rules: [\n            {\n                test: /\\.js$/,\n                exclude: /node_modules/,\n                use: [\n                    "babel-loader",\n                    "eslint-loader"\n                ]\n            }\n        ]\n    }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"_12-webpack-打包组件和基础库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-webpack-打包组件和基础库"}},[s._v("#")]),s._v(" 12. webpack 打包组件和基础库")]),s._v(" "),a("h3",{attrs:{id:"webpack-打包库和组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack-打包库和组件"}},[s._v("#")]),s._v(" webpack 打包库和组件")]),s._v(" "),a("p",[s._v("webpack 除了可以用来打包应用，也可以用来打包 js 库\n实现一个大整数加法库的打包")]),s._v(" "),a("ul",[a("li",[s._v("需要打包压缩版和非压缩版")]),s._v(" "),a("li",[s._v("支持 AMD/CJS/ESM 模块引入")])]),s._v(" "),a("h3",{attrs:{id:"库的目录结构和打包要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#库的目录结构和打包要求"}},[s._v("#")]),s._v(" 库的目录结构和打包要求")]),s._v(" "),a("p",[s._v("打包输出的库名称：")]),s._v(" "),a("ul",[a("li",[s._v("未压缩版 large-number.js")]),s._v(" "),a("li",[s._v("压缩版 large-number.min.js")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338447%2015921106808310%20.jpg",alt:"-w311"}})]),s._v(" "),a("h3",{attrs:{id:"支持的使用方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#支持的使用方式"}},[s._v("#")]),s._v(" 支持的使用方式")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("支持 ES module")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import * as largeNumber from 'large-number';\nlargeNumber.add('999','1');\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("支持 CJS")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const largeNumbers = require('large-number');\nlargeNumber.add('999','1');\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("支持 AMD")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("require(['large-number'],function (large-number) {\n    large-number.add('999','1');\n})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("可以直接通过 script 引入")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<!doctype html> <html>\n...\n<script src=\"https://unpkg.com/large-number\"><\/script> <script>\n// ...\n// Global variable largeNumber.add('999', '1');\n// Property in the window object window. largeNumber.add('999', '1'); // ...\n<\/script> </html>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"如何将库暴露出去"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何将库暴露出去"}},[s._v("#")]),s._v(" 如何将库暴露出去？")]),s._v(" "),a("ul",[a("li",[s._v("library: 指定库的全局变量")]),s._v(" "),a("li",[s._v("library: 支持库引入的方式")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('module.exports = {\n    mode: "production",\n    entry: {\n        "large-number": "./src/index.js",\n        "large-number.min": "./src/index.js"\n    },\n    output: {\n        filename: "[name].js",\n        library: "largeNumber",\n        libraryExport: "default",\n        libraryTarge: "umd"\n    }\n};\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"如何指对-min-压缩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何指对-min-压缩"}},[s._v("#")]),s._v(" 如何指对 .min 压缩")]),s._v(" "),a("p",[s._v("通过 include 设置只压缩 min.js 结尾的文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = {\n    mode: 'none',\n    entry: {\n        'large-number': './src/index.js',\n        'large-number.min': './src/index.js',\n    },\n    output: {\n        filename: '[name].js',\n        library: 'largeNumber',\n        libraryTarget: 'umd'\n    },\n    optimization: {\n        minimize: true,\n        minimizer: [\n            new TerserPlugin({\n                include: /\\.min\\.js$/,\n            })\n        ]\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"设置入口文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置入口文件"}},[s._v("#")]),s._v(" 设置入口文件")]),s._v(" "),a("h4",{attrs:{id:"package-json-的-main-字段为-index-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#package-json-的-main-字段为-index-js"}},[s._v("#")]),s._v(" package.json 的 main 字段为 index.js")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("if (process.env.NODE_ENV === 'production') {\n    module.exports = require('./dist/large-number.min.js');\n} else {\n    module.exports = require('./dist/large-number.js');\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"_13-webpack-实现-ssr-打包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_13-webpack-实现-ssr-打包"}},[s._v("#")]),s._v(" 13. webpack 实现 SSR 打包")]),s._v(" "),a("h4",{attrs:{id:"页面打开过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#页面打开过程"}},[s._v("#")]),s._v(" 页面打开过程")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338459%2015922309368194%20.jpg",alt:"-w1193"}})]),s._v(" "),a("h4",{attrs:{id:"服务端渲染-ssr-是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务端渲染-ssr-是什么"}},[s._v("#")]),s._v(" 服务端渲染（SSR）是什么？")]),s._v(" "),a("ul",[a("li",[s._v("渲染：HTML+CSS+JS+Data -> 渲染后的 HTML")]),s._v(" "),a("li",[s._v("服务端：\n"),a("ul",[a("li",[s._v("所有模板等资源都存储在服务端")]),s._v(" "),a("li",[s._v("内网机器拉取数据更快")]),s._v(" "),a("li",[s._v("一个 HTML 返回所有数据")])])])]),s._v(" "),a("h4",{attrs:{id:"浏览器和服务器交互流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器和服务器交互流程"}},[s._v("#")]),s._v(" 浏览器和服务器交互流程")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("![-w1178](https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338538%2015922313582041%20.jpg)\n")])])]),a("h4",{attrs:{id:"客户端渲染-vs-服务端渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#客户端渲染-vs-服务端渲染"}},[s._v("#")]),s._v(" 客户端渲染 VS 服务端渲染")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338471%2015922314775490%20.jpg",alt:"-w1059"}}),s._v("\n总结：服务端渲染（SSR）的核心是减少请求")]),s._v(" "),a("h4",{attrs:{id:"ssr-的优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssr-的优势"}},[s._v("#")]),s._v(" SSR 的优势")]),s._v(" "),a("ul",[a("li",[s._v("减少白屏时间")]),s._v(" "),a("li",[s._v("对于 SEO 友好")])]),s._v(" "),a("h3",{attrs:{id:"ssr-代码实现思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssr-代码实现思路"}},[s._v("#")]),s._v(" SSR 代码实现思路")]),s._v(" "),a("h4",{attrs:{id:"服务端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务端"}},[s._v("#")]),s._v(" 服务端")]),s._v(" "),a("ul",[a("li",[s._v("使用 react-dom/server 的 renderToString 方法将 React 组件渲染成字符串")]),s._v(" "),a("li",[s._v("服务端路由返回对应的模板")])]),s._v(" "),a("h4",{attrs:{id:"客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#客户端"}},[s._v("#")]),s._v(" 客户端")]),s._v(" "),a("ul",[a("li",[s._v("打包出针对服务端的组件")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338483%2015922317971142%20.jpg",alt:"-w453"}})]),s._v(" "),a("h3",{attrs:{id:"webpack-ssr-打包存在的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack-ssr-打包存在的问题"}},[s._v("#")]),s._v(" webpack ssr 打包存在的问题")]),s._v(" "),a("h4",{attrs:{id:"浏览器的全局变量-node-js-中没有-document-window"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的全局变量-node-js-中没有-document-window"}},[s._v("#")]),s._v(" 浏览器的全局变量（Node.js 中没有 document, window）")]),s._v(" "),a("ul",[a("li",[s._v("组件适配：将不兼容的组件根据打包环境进行适配")]),s._v(" "),a("li",[s._v("请求适配：将 fetch 或者 ajax 发送请求的写法改成 isomorphic-fetch 或者 axios")])]),s._v(" "),a("h4",{attrs:{id:"样式问题-node-js-无法解析-css"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#样式问题-node-js-无法解析-css"}},[s._v("#")]),s._v(" 样式问题（Node.js 无法解析 css）")]),s._v(" "),a("ul",[a("li",[s._v("方案一：服务端打包通过 ignore-loader 忽略 CSS 的解析")]),s._v(" "),a("li",[s._v("方案二：将 style-loader 替换成 isomorphic-style-loader")])]),s._v(" "),a("h4",{attrs:{id:"如何解决样式不显示的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何解决样式不显示的问题"}},[s._v("#")]),s._v(" 如何解决样式不显示的问题？")]),s._v(" "),a("ul",[a("li",[s._v("使用打包出来的浏览器端 html 为模板")]),s._v(" "),a("li",[s._v("设置占位符，动态插入组件\n"),a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338494%2015938317402123%20.jpg",alt:"-w427"}})])]),s._v(" "),a("h4",{attrs:{id:"首屏数据如何处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首屏数据如何处理"}},[s._v("#")]),s._v(" 首屏数据如何处理？")]),s._v(" "),a("ul",[a("li",[s._v("服务端获取数据")]),s._v(" "),a("li",[s._v("替换占位符\n"),a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338505%2015938541966729%20.jpg",alt:"-w445"}})])]),s._v(" "),a("h2",{attrs:{id:"_14-优化构建时命令行的显示日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_14-优化构建时命令行的显示日志"}},[s._v("#")]),s._v(" 14. 优化构建时命令行的显示日志")]),s._v(" "),a("h4",{attrs:{id:"当前构建是的日志显示"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#当前构建是的日志显示"}},[s._v("#")]),s._v(" 当前构建是的日志显示")]),s._v(" "),a("p",[s._v("展示一大堆日志，很多并不需要开发者关注")]),s._v(" "),a("h4",{attrs:{id:"统计信息-stats"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#统计信息-stats"}},[s._v("#")]),s._v(" 统计信息 stats")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338516%2015938573704035%20.jpg",alt:"-w751"}})]),s._v(" "),a("h3",{attrs:{id:"如何优化命令行的构建日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何优化命令行的构建日志"}},[s._v("#")]),s._v(" 如何优化命令行的构建日志")]),s._v(" "),a("h4",{attrs:{id:"使用-friendly-errors-webpack-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-friendly-errors-webpack-plugin"}},[s._v("#")]),s._v(" 使用 friendly-errors-webpack-plugin")]),s._v(" "),a("ul",[a("li",[s._v("success：构建成功的日志提示")]),s._v(" "),a("li",[s._v("warning：构建警告的日志提示")]),s._v(" "),a("li",[s._v("error：构建报错的日志提示")])]),s._v(" "),a("h4",{attrs:{id:"stats-设置成-errors-only"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stats-设置成-errors-only"}},[s._v("#")]),s._v(" stats 设置成 errors-only")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module.exports = { entry: {\napp: './src/app.js',\nsearch: './src/search.js' },\noutput: {\nfilename: '[name][chunkhash:8].js', path: __dirname + '/dist'\n},\nplugins: [\n+ new FriendlyErrorsWebpackPlugin()\n],\n+ stats: 'errors-only' };\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h4",{attrs:{id:"使用效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用效果"}},[s._v("#")]),s._v(" 使用效果")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338527%2015938579756021%20.jpg",alt:"-w919"}})]),s._v(" "),a("h2",{attrs:{id:"_15-构建异常和中断处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-构建异常和中断处理"}},[s._v("#")]),s._v(" 15. 构建异常和中断处理")]),s._v(" "),a("h4",{attrs:{id:"如何判断构建是否成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何判断构建是否成功"}},[s._v("#")]),s._v(" 如何判断构建是否成功？")]),s._v(" "),a("p",[s._v("在 CI/CD 的 pipline 或者发布系统需要知道当前构建状态\n每次构建完成后输入 echo $? 获取错误码")]),s._v(" "),a("p",[s._v("webpack4 之前的版本构建失败不会抛出错误码（error code）")]),s._v(" "),a("p",[s._v("Node.js 中的 process.exit 规范")]),s._v(" "),a("ul",[a("li",[s._v("0 表示成功完成，回调函数中，err 为 null")]),s._v(" "),a("li",[s._v("非 0 表示执行失败，回调函数中，err 不为 null，err.code 就是传给 exit 的数字")])]),s._v(" "),a("p",[s._v("compiler 在每次构建结束后会触发 done 这个 hook\nprocess.exit 主动处理构建报错")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("plugins: [ function() {\nthis.hooks.done.tap('done', (stats) => { if (stats.compilation.errors &&\nstats.compilation.errors.length && process.argv.indexOf('- -watch') == -1)\n{\nconsole.log('build error');\nprocess.exit(1); }\n}) }\n]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);