<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>三、基础篇：webpack 进阶用法 | chst365&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" size="152x152" href="/img/apple-touch-icon.png">
    <script data-website-id="d37fd1ba-3ce4-4443-b8d7-88c163c8f9c2" async="async" src="https://umami.smart-lzgz.cn/umami.js"></script>
    <script src="/js/matomo.js"></script>
    <meta name="description" content="">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/img/144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.e6183182.css" as="style"><link rel="preload" href="/assets/js/app.e873eaec.js" as="script"><link rel="preload" href="/assets/js/2.c3598815.js" as="script"><link rel="preload" href="/assets/js/13.338c9daa.js" as="script"><link rel="prefetch" href="/assets/js/10.783ae79f.js"><link rel="prefetch" href="/assets/js/100.bd3df897.js"><link rel="prefetch" href="/assets/js/101.c7201acf.js"><link rel="prefetch" href="/assets/js/102.cfd0aa29.js"><link rel="prefetch" href="/assets/js/103.d840b53f.js"><link rel="prefetch" href="/assets/js/104.2ddfcfb8.js"><link rel="prefetch" href="/assets/js/105.6ea49fa2.js"><link rel="prefetch" href="/assets/js/106.b4db7856.js"><link rel="prefetch" href="/assets/js/11.b493afe0.js"><link rel="prefetch" href="/assets/js/12.f2b638e9.js"><link rel="prefetch" href="/assets/js/14.386ba68c.js"><link rel="prefetch" href="/assets/js/15.69b7b6d2.js"><link rel="prefetch" href="/assets/js/16.77f11b30.js"><link rel="prefetch" href="/assets/js/17.bb677288.js"><link rel="prefetch" href="/assets/js/18.508b67eb.js"><link rel="prefetch" href="/assets/js/19.1baf2e7f.js"><link rel="prefetch" href="/assets/js/20.9ff5f4d6.js"><link rel="prefetch" href="/assets/js/21.379d0a51.js"><link rel="prefetch" href="/assets/js/22.bc0cf0cb.js"><link rel="prefetch" href="/assets/js/23.896f53e7.js"><link rel="prefetch" href="/assets/js/24.9e195afa.js"><link rel="prefetch" href="/assets/js/25.4ef430d4.js"><link rel="prefetch" href="/assets/js/26.1d67866e.js"><link rel="prefetch" href="/assets/js/27.337ed3d4.js"><link rel="prefetch" href="/assets/js/28.5faa2b73.js"><link rel="prefetch" href="/assets/js/29.088d2e68.js"><link rel="prefetch" href="/assets/js/3.32661874.js"><link rel="prefetch" href="/assets/js/30.233243c0.js"><link rel="prefetch" href="/assets/js/31.68649ade.js"><link rel="prefetch" href="/assets/js/32.d8045680.js"><link rel="prefetch" href="/assets/js/33.73fde3f0.js"><link rel="prefetch" href="/assets/js/34.6b7c4284.js"><link rel="prefetch" href="/assets/js/35.0750befa.js"><link rel="prefetch" href="/assets/js/36.f32dffc0.js"><link rel="prefetch" href="/assets/js/37.630bedfa.js"><link rel="prefetch" href="/assets/js/38.2dd75216.js"><link rel="prefetch" href="/assets/js/39.f0f37074.js"><link rel="prefetch" href="/assets/js/4.61ff1519.js"><link rel="prefetch" href="/assets/js/40.7919b4fa.js"><link rel="prefetch" href="/assets/js/41.c8d44809.js"><link rel="prefetch" href="/assets/js/42.be9081c5.js"><link rel="prefetch" href="/assets/js/43.ad8f3b94.js"><link rel="prefetch" href="/assets/js/44.dcd8bd49.js"><link rel="prefetch" href="/assets/js/45.896ed759.js"><link rel="prefetch" href="/assets/js/46.f595a74a.js"><link rel="prefetch" href="/assets/js/47.c85f81d6.js"><link rel="prefetch" href="/assets/js/48.98a70975.js"><link rel="prefetch" href="/assets/js/49.70ecd6aa.js"><link rel="prefetch" href="/assets/js/5.3e3ef80c.js"><link rel="prefetch" href="/assets/js/50.f0dbd9df.js"><link rel="prefetch" href="/assets/js/51.5ea2c160.js"><link rel="prefetch" href="/assets/js/52.db72f4cc.js"><link rel="prefetch" href="/assets/js/53.f9a9b495.js"><link rel="prefetch" href="/assets/js/54.02e1b47d.js"><link rel="prefetch" href="/assets/js/55.4db369ea.js"><link rel="prefetch" href="/assets/js/56.cf5d53bd.js"><link rel="prefetch" href="/assets/js/57.5ee6dfcd.js"><link rel="prefetch" href="/assets/js/58.1e53d695.js"><link rel="prefetch" href="/assets/js/59.0e97ddef.js"><link rel="prefetch" href="/assets/js/6.82e034b9.js"><link rel="prefetch" href="/assets/js/60.667a86f1.js"><link rel="prefetch" href="/assets/js/61.f1d46c6a.js"><link rel="prefetch" href="/assets/js/62.8c4e7a7d.js"><link rel="prefetch" href="/assets/js/63.5e29671a.js"><link rel="prefetch" href="/assets/js/64.4304aa8b.js"><link rel="prefetch" href="/assets/js/65.27a7923f.js"><link rel="prefetch" href="/assets/js/66.c62e9118.js"><link rel="prefetch" href="/assets/js/67.ae3a2c59.js"><link rel="prefetch" href="/assets/js/68.8a62ae0d.js"><link rel="prefetch" href="/assets/js/69.090446a1.js"><link rel="prefetch" href="/assets/js/7.84e21fbe.js"><link rel="prefetch" href="/assets/js/70.178485d6.js"><link rel="prefetch" href="/assets/js/71.c115b0d7.js"><link rel="prefetch" href="/assets/js/72.8d3653eb.js"><link rel="prefetch" href="/assets/js/73.c5a39d04.js"><link rel="prefetch" href="/assets/js/74.330bfbbf.js"><link rel="prefetch" href="/assets/js/75.994564fa.js"><link rel="prefetch" href="/assets/js/76.5e250a8a.js"><link rel="prefetch" href="/assets/js/77.a5e859e3.js"><link rel="prefetch" href="/assets/js/78.31e7f649.js"><link rel="prefetch" href="/assets/js/79.694202ec.js"><link rel="prefetch" href="/assets/js/8.d2e29a1b.js"><link rel="prefetch" href="/assets/js/80.92c43f58.js"><link rel="prefetch" href="/assets/js/81.e9f689eb.js"><link rel="prefetch" href="/assets/js/82.434c6d98.js"><link rel="prefetch" href="/assets/js/83.76ccf373.js"><link rel="prefetch" href="/assets/js/84.bb78e54c.js"><link rel="prefetch" href="/assets/js/85.d29f96f1.js"><link rel="prefetch" href="/assets/js/86.0dbe7642.js"><link rel="prefetch" href="/assets/js/87.1525f940.js"><link rel="prefetch" href="/assets/js/88.2a2abddb.js"><link rel="prefetch" href="/assets/js/89.cf9f5cf2.js"><link rel="prefetch" href="/assets/js/9.f582e724.js"><link rel="prefetch" href="/assets/js/90.b27e0bb7.js"><link rel="prefetch" href="/assets/js/91.1d881d67.js"><link rel="prefetch" href="/assets/js/92.2ed0ca34.js"><link rel="prefetch" href="/assets/js/93.95867c96.js"><link rel="prefetch" href="/assets/js/94.2fbd7098.js"><link rel="prefetch" href="/assets/js/95.7da3ca86.js"><link rel="prefetch" href="/assets/js/96.8eebbf67.js"><link rel="prefetch" href="/assets/js/97.99b3bc67.js"><link rel="prefetch" href="/assets/js/98.617efc4b.js"><link rel="prefetch" href="/assets/js/99.6483b027.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e6183182.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="chst365's blog" class="logo"> <span class="site-name can-hide">chst365's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发必备" class="dropdown-title"><a href="/basic/" class="link-title">开发必备</a> <span class="title" style="display:none;">开发必备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7a6999/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/pages/857e93/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/pages/d8e2cc/" class="nav-link">操作系统</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/270f88/" class="nav-link">浏览器</a></li><li class="dropdown-item"><!----> <a href="/pages/a1323f/" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/pages/d1b7c1/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/pages/b3d0bc/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/pages/ba2200/" class="nav-link">性能</a></li><li class="dropdown-item"><!----> <a href="/pages/cadd60/" class="nav-link">工程化</a></li><li class="dropdown-item"><!----> <a href="/pages/483d46/" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/pages/35ccf0/" class="nav-link">编程题</a></li><li class="dropdown-item"><!----> <a href="/pages/d382d4/" class="nav-link">React技术揭秘</a></li><li class="dropdown-item"><!----> <a href="/pages/e1c67e/" class="nav-link">算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/basic/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/25e852/" class="nav-link">Node</a></li></ul></div></div><div class="nav-item"><a href="/notes/" class="nav-link">杂记</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/logo.png"> <div class="blogger-info"><h3>chst365</h3> <span>DIV工程师</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发必备" class="dropdown-title"><a href="/basic/" class="link-title">开发必备</a> <span class="title" style="display:none;">开发必备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/7a6999/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/pages/857e93/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/pages/d8e2cc/" class="nav-link">操作系统</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/270f88/" class="nav-link">浏览器</a></li><li class="dropdown-item"><!----> <a href="/pages/a1323f/" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/pages/d1b7c1/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/pages/b3d0bc/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/pages/ba2200/" class="nav-link">性能</a></li><li class="dropdown-item"><!----> <a href="/pages/cadd60/" class="nav-link">工程化</a></li><li class="dropdown-item"><!----> <a href="/pages/483d46/" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/pages/35ccf0/" class="nav-link">编程题</a></li><li class="dropdown-item"><!----> <a href="/pages/d382d4/" class="nav-link">React技术揭秘</a></li><li class="dropdown-item"><!----> <a href="/pages/e1c67e/" class="nav-link">算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/basic/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/25e852/" class="nav-link">Node</a></li></ul></div></div><div class="nav-item"><a href="/notes/" class="nav-link">杂记</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>webpack</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/a1323f/" class="sidebar-link">一、基础篇：webpack与构建发展简史</a></li><li><a href="/pages/2d4c68/" class="sidebar-link">二、基础篇：webpack 基础用法</a></li><li><a href="/pages/e8c65e/" aria-current="page" class="active sidebar-link">三、基础篇：webpack 进阶用法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_1-自动清理构建目标产物" class="sidebar-link">1. 自动清理构建目标产物</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#当前构建时的问题" class="sidebar-link">当前构建时的问题</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#通过-npm-scripts-清理构建目录" class="sidebar-link">通过 npm scripts 清理构建目录</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#自动清理构建目录" class="sidebar-link">自动清理构建目录</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_2-postcss-插件-autoprefixer-自动补齐-css3-前缀" class="sidebar-link">2. PostCSS 插件 autoprefixer 自动补齐 CSS3 前缀</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#css3-的属性为什么需要前缀" class="sidebar-link">CSS3 的属性为什么需要前缀</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#postcss" class="sidebar-link">PostCSS</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_3-移动端-css-px-自动转换成-rem" class="sidebar-link">3. 移动端 CSS px 自动转换成 rem</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#浏览器的分辨率" class="sidebar-link">浏览器的分辨率</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#css-媒体查询实现响应式布局" class="sidebar-link">CSS 媒体查询实现响应式布局</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#rem" class="sidebar-link">rem</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#移动端-css-px-自动转换成-rem" class="sidebar-link">移动端 CSS px 自动转换成 rem</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_4-静态资源内联" class="sidebar-link">4. 静态资源内联</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_4-1-资源内联的意义" class="sidebar-link">4.1 资源内联的意义</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_4-2-html-和-js-内联" class="sidebar-link">4.2 HTML 和 JS 内联</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_4-3-css-内联" class="sidebar-link">4.3 CSS 内联</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_5-多页面应用打包通用方案" class="sidebar-link">5. 多页面应用打包通用方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#多页面应用-mpa-概念" class="sidebar-link">多页面应用（MPA）概念</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#多页面打包基本思路" class="sidebar-link">多页面打包基本思路</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_6-使用-sourcemap" class="sidebar-link">6. 使用 sourcemap</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#使用-source-map" class="sidebar-link">使用 source map</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#source-map-关键字" class="sidebar-link">source map 关键字</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#source-map-类型" class="sidebar-link">source map 类型</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_7-提取页面公共资源" class="sidebar-link">7. 提取页面公共资源</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#基础库分离" class="sidebar-link">基础库分离</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#利用-splitchunksplugin-进行公共脚本分离" class="sidebar-link">利用 SplitChunksPlugin 进行公共脚本分离</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#利用-splitchunksplugin-分离基础包" class="sidebar-link">利用 SplitChunksPlugin 分离基础包</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#利用-splitchunksplugin-分离页面公共文件" class="sidebar-link">利用 SplitChunksPlugin 分离页面公共文件</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_8-treeshaking-的使用和原理分析" class="sidebar-link">8. treeshaking 的使用和原理分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#tree-shaking-摇树优化" class="sidebar-link">tree shaking (摇树优化)</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#dce-elimination" class="sidebar-link">DCE（Elimination）</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#tree-shaking-原理" class="sidebar-link">Tree-shaking 原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_9-scopehoisting-使用和原理分析" class="sidebar-link">9. ScopeHoisting 使用和原理分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#现象-构建后的代码存在大量闭包代码" class="sidebar-link">现象：构建后的代码存在大量闭包代码</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#会导致什么问题" class="sidebar-link">会导致什么问题？</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#模块转换分析" class="sidebar-link">模块转换分析</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#进一步分析-webpack-的模块机制" class="sidebar-link">进一步分析 webpack 的模块机制</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#scope-hoisting-原理" class="sidebar-link">scope hoisting 原理</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#scope-hoisting-使用" class="sidebar-link">scope hoisting 使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_10-代码分割和动态-import" class="sidebar-link">10. 代码分割和动态 import</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_11-webpack-和-eslint-结合" class="sidebar-link">11. webpack 和 ESLint 结合</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#eslint-的必要性" class="sidebar-link">ESLint 的必要性</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#行业里面优秀的-eslint-规范实践" class="sidebar-link">行业里面优秀的 ESLint 规范实践</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#制定团队的-eslint-规范" class="sidebar-link">制定团队的 ESLint 规范</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#eslint-如何执行落地" class="sidebar-link">ESLint 如何执行落地？</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_12-webpack-打包组件和基础库" class="sidebar-link">12. webpack 打包组件和基础库</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#webpack-打包库和组件" class="sidebar-link">webpack 打包库和组件</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#库的目录结构和打包要求" class="sidebar-link">库的目录结构和打包要求</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#支持的使用方式" class="sidebar-link">支持的使用方式</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#如何将库暴露出去" class="sidebar-link">如何将库暴露出去？</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#如何指对-min-压缩" class="sidebar-link">如何指对 .min 压缩</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#设置入口文件" class="sidebar-link">设置入口文件</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_13-webpack-实现-ssr-打包" class="sidebar-link">13. webpack 实现 SSR 打包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#ssr-代码实现思路" class="sidebar-link">SSR 代码实现思路</a></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#webpack-ssr-打包存在的问题" class="sidebar-link">webpack ssr 打包存在的问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_14-优化构建时命令行的显示日志" class="sidebar-link">14. 优化构建时命令行的显示日志</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e8c65e/#如何优化命令行的构建日志" class="sidebar-link">如何优化命令行的构建日志</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e8c65e/#_15-构建异常和中断处理" class="sidebar-link">15. 构建异常和中断处理</a></li></ul></li><li><a href="/pages/14b103/" class="sidebar-link">四、进阶篇：编写可维护的 webpack 构建配置</a></li><li><a href="/pages/4bf87e/" class="sidebar-link">五、进阶篇：webpack 构建速度和体积优化策略</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编程题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React技术揭秘</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/categories/?category=%E5%89%8D%E7%AB%AF" title="分类" data-v-1cd794fe>前端</a></li> <li data-v-1cd794fe><a href="/categories/?category=webpack" title="分类" data-v-1cd794fe>webpack</a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/chst365" target="_blank" title="作者" class="beLink" data-v-1cd794fe>chst365</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2020-06-02</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          三、基础篇：webpack 进阶用法
        </h1>  <div class="theme-vdoing-content content__default"><p><img src="https://cdn.jsdelivr.net/gh/chst365/bolgImgs/imgs/topImgs/252.jpg" alt=""></p> <h1 id="三、基础篇-webpack-进阶用法"><a href="#三、基础篇-webpack-进阶用法" class="header-anchor">#</a> 三、基础篇：webpack 进阶用法</h1> <h2 id="_1-自动清理构建目标产物"><a href="#_1-自动清理构建目标产物" class="header-anchor">#</a> 1. 自动清理构建目标产物</h2> <h3 id="当前构建时的问题"><a href="#当前构建时的问题" class="header-anchor">#</a> 当前构建时的问题</h3> <p>每次构建的时候不会清理目录，造成构建的输出目录 output 文件越来越多</p> <h3 id="通过-npm-scripts-清理构建目录"><a href="#通过-npm-scripts-清理构建目录" class="header-anchor">#</a> 通过 npm scripts 清理构建目录</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>rm -rf ./dist &amp;&amp; webpack
rimraf ./dist &amp;&amp; webpack
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="自动清理构建目录"><a href="#自动清理构建目录" class="header-anchor">#</a> 自动清理构建目录</h3> <p>避免构建前每次都需要手动删除 dist</p> <p>使用 clean-webpack-plugin * 默认会删除 output 指定的输出目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    entry: {
        app: './src/app.js',
        search: './src/search.js'
    },
    output: {
        filename: '[name][chunkhash:8].js',
        path: __dirname + '/dist'
    },
    plugins: [
        new CleanWebpackPlugin({})
    ]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_2-postcss-插件-autoprefixer-自动补齐-css3-前缀"><a href="#_2-postcss-插件-autoprefixer-自动补齐-css3-前缀" class="header-anchor">#</a> 2. PostCSS 插件 autoprefixer 自动补齐 CSS3 前缀</h2> <h3 id="css3-的属性为什么需要前缀"><a href="#css3-的属性为什么需要前缀" class="header-anchor">#</a> CSS3 的属性为什么需要前缀</h3> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338300%2015911113556100%20.jpg" alt="-w1452"></p> <h3 id="postcss"><a href="#postcss" class="header-anchor">#</a> PostCSS</h3> <p>使用 autoprefixer 插件
根据 Can I Use 规则（<a href="https://caniuse.com/" target="_blank" rel="noopener noreferrer">https://caniuse.com/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    module: {
        rules: [
            {
                test: /\.less$/,
                use: [
                    'style-loader',
                    'css-loader',
                    'less-loader',
                    {
                        loader: 'postcss-loader',
                        options: {
                            plugins: () =&gt; [
                                require('autoprefixer')({
                                browsers: [&quot;last 2 version&quot;, &quot;&gt;1%&quot;,&quot;iOS 7&quot;]
                                })
                            ]
                        }
                    }
                ]
            }
        ]
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="_3-移动端-css-px-自动转换成-rem"><a href="#_3-移动端-css-px-自动转换成-rem" class="header-anchor">#</a> 3. 移动端 CSS px 自动转换成 rem</h2> <h3 id="浏览器的分辨率"><a href="#浏览器的分辨率" class="header-anchor">#</a> 浏览器的分辨率</h3> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338313%2015915420734573%20.jpg" alt="-w1202"></p> <h3 id="css-媒体查询实现响应式布局"><a href="#css-媒体查询实现响应式布局" class="header-anchor">#</a> CSS 媒体查询实现响应式布局</h3> <p>缺陷：需要写多套适配样式代码</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@media screen and (max-width: 980px) {
    .header {
        width: 900px;
    }
}
@media screen and (max-width: 480px) {
    .header {
        height: 400px;
    }
}
@media screen and (max-width: 480px) {
    .header {
        height: 300px;
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="rem"><a href="#rem" class="header-anchor">#</a> rem</h3> <p>W3C 对 rem 的定义：font-size of the root element
rem 和 px 的对比：
_ rem 是相对单位
_ px 是绝对单位</p> <h3 id="移动端-css-px-自动转换成-rem"><a href="#移动端-css-px-自动转换成-rem" class="header-anchor">#</a> 移动端 CSS px 自动转换成 rem</h3> <h4 id="使用-px2rem-loader"><a href="#使用-px2rem-loader" class="header-anchor">#</a> 使用 px2rem-loader</h4> <h4 id="页面渲染时计算根元素的-font-size-值"><a href="#页面渲染时计算根元素的-font-size-值" class="header-anchor">#</a> 页面渲染时计算根元素的 font-size 值</h4> <ul><li>可以使用手淘的 lib-flexible 库</li> <li><a href="https://github.com/amfe/lib-flexible" target="_blank" rel="noopener noreferrer">https://github.com/amfe/lib-flexible<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    module: {
        rules: [
            {
                test: /\.less$/,
                use: [
                    'style-loader',
                    'css-loader',
                    'less-loader',
                    {
                        loader: 'px2rem-loader',
                        options: {
                            remUnit: 75,
                            remPrecision: 8
                        }
                    }
                ]
            }
        ]
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="_4-静态资源内联"><a href="#_4-静态资源内联" class="header-anchor">#</a> 4. 静态资源内联</h2> <h3 id="_4-1-资源内联的意义"><a href="#_4-1-资源内联的意义" class="header-anchor">#</a> 4.1 资源内联的意义</h3> <h4 id="代码层面"><a href="#代码层面" class="header-anchor">#</a> 代码层面：</h4> <ul><li>页面框架的初始化脚本</li> <li>上报相关打点</li> <li>css 内联避免页面闪动</li></ul> <h4 id="请求层面-减少-http-网络请求数"><a href="#请求层面-减少-http-网络请求数" class="header-anchor">#</a> 请求层面：减少 HTTP 网络请求数</h4> <ul><li>小图片或者字体内联（url-loader）</li></ul> <h3 id="_4-2-html-和-js-内联"><a href="#_4-2-html-和-js-内联" class="header-anchor">#</a> 4.2 HTML 和 JS 内联</h3> <h4 id="raw-loader-内联-html"><a href="#raw-loader-内联-html" class="header-anchor">#</a> raw-loader 内联 html</h4> <p><code>&lt;script&gt;${require('raw-loader!babel-loader!./meta.html')}&lt;/script&gt;</code></p> <h4 id="raw-loader-内联-js"><a href="#raw-loader-内联-js" class="header-anchor">#</a> raw-loader 内联 JS</h4> <p><code>&lt;script&gt;${require('raw-loader!babel-loader!../node_modules/lib-flexible')}&lt;/script&gt;</code></p> <h3 id="_4-3-css-内联"><a href="#_4-3-css-内联" class="header-anchor">#</a> 4.3 CSS 内联</h3> <h4 id="方案一-借助-style-loader"><a href="#方案一-借助-style-loader" class="header-anchor">#</a> 方案一：借助 style-loader</h4> <h4 id="方案二-html-inline-css-webpack-plugin"><a href="#方案二-html-inline-css-webpack-plugin" class="header-anchor">#</a> 方案二：html-inline-css-webpack-plugin</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    module: {
        rules: [
            {
                test: /\.scss$/,
                use: [
                    {
                        loader: 'style-loader',
                        options: {
                            insertAt: 'top',        // 样式插入到 &lt;head&gt;
                            singleton: true,        // 将所有的style标签合并成一个
                        }
                    },
                    'css-loader',
                    'sass-loader'
                ]
            }
        ]
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="_5-多页面应用打包通用方案"><a href="#_5-多页面应用打包通用方案" class="header-anchor">#</a> 5. 多页面应用打包通用方案</h2> <h3 id="多页面应用-mpa-概念"><a href="#多页面应用-mpa-概念" class="header-anchor">#</a> 多页面应用（MPA）概念</h3> <p>每一次页面跳转的时候，后台服务器都会给返回一个新的 html 文档，这种类型的网站也就是多页面网站，也叫多页面应用。</p> <h3 id="多页面打包基本思路"><a href="#多页面打包基本思路" class="header-anchor">#</a> 多页面打包基本思路</h3> <h4 id="方案一-每个页面对应一个-entry-一个-html-webpack-plugin"><a href="#方案一-每个页面对应一个-entry-一个-html-webpack-plugin" class="header-anchor">#</a> 方案一：每个页面对应一个 entry,一个 html-webpack-plugin</h4> <h4 id="缺点-每次新增或删除页面需要改-webpack-配置"><a href="#缺点-每次新增或删除页面需要改-webpack-配置" class="header-anchor">#</a> 缺点：每次新增或删除页面需要改 webpack 配置</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    entry: {
        index: './src/index.js',
        search: './src/search.js'
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="方案二-动态获取-entry-和设置-html-webpack-plugin-数量"><a href="#方案二-动态获取-entry-和设置-html-webpack-plugin-数量" class="header-anchor">#</a> 方案二: 动态获取 entry 和设置 html-webpack-plugin 数量</h4> <h4 id="利用-glob-sync"><a href="#利用-glob-sync" class="header-anchor">#</a> 利用 glob.sync</h4> <ul><li>entry: glob.sync(path.join(__dirname, './src/*/index.js'))</li></ul> <h2 id="_6-使用-sourcemap"><a href="#_6-使用-sourcemap" class="header-anchor">#</a> 6. 使用 sourcemap</h2> <h3 id="使用-source-map"><a href="#使用-source-map" class="header-anchor">#</a> 使用 source map</h3> <h4 id="作用-通过-source-map-定位到源代码"><a href="#作用-通过-source-map-定位到源代码" class="header-anchor">#</a> 作用：通过 source map 定位到源代码</h4> <ul><li>source map 科普文：<a href="http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html" target="_blank" rel="noopener noreferrer">http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h4 id="开发环境开启-线上环境关闭"><a href="#开发环境开启-线上环境关闭" class="header-anchor">#</a> 开发环境开启，线上环境关闭</h4> <ul><li>线上排除问题的时候可以将 sourcemap 上传到错误监控系统</li></ul> <h3 id="source-map-关键字"><a href="#source-map-关键字" class="header-anchor">#</a> source map 关键字</h3> <ul><li>eval: 使用 eval 包裹模块代码</li> <li>source map: 产生.map 文件</li> <li>cheap: 不包含列信息</li> <li>inline: 将 .map 作为 DataURI 嵌入，不单独生成 .map 文件</li> <li>module: 包含 loader 的 sourcemap</li></ul> <h3 id="source-map-类型"><a href="#source-map-类型" class="header-anchor">#</a> source map 类型</h3> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338326%2015917134505654%20.jpg" alt="-w754"></p> <h2 id="_7-提取页面公共资源"><a href="#_7-提取页面公共资源" class="header-anchor">#</a> 7. 提取页面公共资源</h2> <h3 id="基础库分离"><a href="#基础库分离" class="header-anchor">#</a> 基础库分离</h3> <ul><li>思路： 将 react、react-dom 基础包通过 cdn 引入，不打入 bundle 中</li> <li>方法： 使用 html-webpack-externals-plugin
<img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338338%2015917144560217%20.jpg" alt="-w700"></li></ul> <h3 id="利用-splitchunksplugin-进行公共脚本分离"><a href="#利用-splitchunksplugin-进行公共脚本分离" class="header-anchor">#</a> 利用 SplitChunksPlugin 进行公共脚本分离</h3> <p>Webpack 4 内置的，替代 CommonsChunkPlugin 插件</p> <p>chunks 参数说明：</p> <ul><li>async 异步引入的库进行分离（默认）</li> <li>initial 同步引入的库进行分离</li> <li>all 所有引入的库进行分离（推荐）</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    optimization: {
        splitChunks: {
            chunks: 'async',
            minSize: 30000,                             // 抽离公共包最小大小（字节）
            maxSize: 0,                                 // 最大大小
            minChunks: 3,                               // 公共代码出现的次数
            maxAsyncRequests: 5,                        //
            maxInitialRequests: 3,
            automaticNameDelimiter: '~',
            name: true,
            cacheGroups: {
                vendors: {
                    test: /[\\/]node_modules[\\/]/,
                    priority: -10
                }
            }
        }
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="利用-splitchunksplugin-分离基础包"><a href="#利用-splitchunksplugin-分离基础包" class="header-anchor">#</a> 利用 SplitChunksPlugin 分离基础包</h3> <h4 id="test-匹配出需要分离的包"><a href="#test-匹配出需要分离的包" class="header-anchor">#</a> test: 匹配出需要分离的包</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    optimization: {
        splitChunks: {
            cacheGroups: {
                commons: {
                    test: /(react|react-dom)/,
                    name: 'vendors',
                    chunks: 'all'
                }
            }
        }
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="利用-splitchunksplugin-分离页面公共文件"><a href="#利用-splitchunksplugin-分离页面公共文件" class="header-anchor">#</a> 利用 SplitChunksPlugin 分离页面公共文件</h3> <ul><li>minChunks: 设置最小引用次数为 2 次</li> <li>minSize: 分离的包体积的大小</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    optimization: {
        splitChunks: {
            minSize: 0,
            cacheGroups: {
                commons: {
                    name: 'vendors',
                    chunks: 'all',
                    minChunks: 2
                }
            }
        }
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_8-treeshaking-的使用和原理分析"><a href="#_8-treeshaking-的使用和原理分析" class="header-anchor">#</a> 8. treeshaking 的使用和原理分析</h2> <h3 id="tree-shaking-摇树优化"><a href="#tree-shaking-摇树优化" class="header-anchor">#</a> tree shaking (摇树优化)</h3> <p>概念：一个模块可能有多个方法，只要其中的某个方法使用到了，则整个文件都会被打到 bundle 里面去，tree shaking 就是只把用到的方法打入 bundle，没用到的方法会在 uglify 阶段被擦出掉。
使用：</p> <ul><li>webpack 默认支持，在 .babelrc 里设置 modules: false 即可</li> <li>production mode 的情况下默认开启
要求：必须是 ES6 的语法，CJS 的方式不支持</li></ul> <h3 id="dce-elimination"><a href="#dce-elimination" class="header-anchor">#</a> DCE（Elimination）</h3> <h4 id="代码不会被执行-不可到达"><a href="#代码不会被执行-不可到达" class="header-anchor">#</a> 代码不会被执行，不可到达</h4> <h4 id="代码执行的结果不会被用到"><a href="#代码执行的结果不会被用到" class="header-anchor">#</a> 代码执行的结果不会被用到</h4> <h4 id="代码只会影响死变量-只写不读"><a href="#代码只会影响死变量-只写不读" class="header-anchor">#</a> 代码只会影响死变量（只写不读）</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>if(false) {
    console.log('这段代码永远不会执行');
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="tree-shaking-原理"><a href="#tree-shaking-原理" class="header-anchor">#</a> Tree-shaking 原理</h3> <p>利用 ES6 模块的特点：</p> <ul><li>只能作为模块顶层的语句出现</li> <li>import 的模块名只能是字符串常量</li> <li>import binding 是 immutable 的
代码擦除：uglify 阶段删除无用代码</li></ul> <h2 id="_9-scopehoisting-使用和原理分析"><a href="#_9-scopehoisting-使用和原理分析" class="header-anchor">#</a> 9. ScopeHoisting 使用和原理分析</h2> <h3 id="现象-构建后的代码存在大量闭包代码"><a href="#现象-构建后的代码存在大量闭包代码" class="header-anchor">#</a> 现象：构建后的代码存在大量闭包代码</h3> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338351%2015920375653898%20.jpg" alt="-w1115"></p> <h3 id="会导致什么问题"><a href="#会导致什么问题" class="header-anchor">#</a> 会导致什么问题？</h3> <ul><li>大量函数闭包包裹代码，导致体积增大（模块越多越明显）</li> <li>运行代码时创建的函数作用域变多，内存开销变大</li></ul> <h3 id="模块转换分析"><a href="#模块转换分析" class="header-anchor">#</a> 模块转换分析</h3> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338362%2015920384312103%20.jpg" alt="-w1254"></p> <p>结论：</p> <ul><li>被 webpack 转换后的模块会带上一层包裹</li> <li>import 会被转换成 __webpack_require</li></ul> <h3 id="进一步分析-webpack-的模块机制"><a href="#进一步分析-webpack-的模块机制" class="header-anchor">#</a> 进一步分析 webpack 的模块机制</h3> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338376%2015920387012256%20.jpg" alt="-w582"></p> <p>分析：</p> <ul><li>打包出来的是一个 IIFE（匿名闭包）</li> <li>modules 是一个数组，每一项是一个模块初始化函数</li> <li>__webpack_require 用来加载模块，返回 module.exports</li> <li>通过 WEBPACK_REQUIRE_METHOD(0) 启动程序</li></ul> <h3 id="scope-hoisting-原理"><a href="#scope-hoisting-原理" class="header-anchor">#</a> scope hoisting 原理</h3> <p>原理：将所有模块的代码按照引用顺序放在一个函数作用域里，然后适当的重命名一些变量以防止变量名冲突
对比：通过 scope hoisting 可以减少函数声明代码和内存开销
<img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338389%2015920390682548%20.jpg" alt="-w1099"></p> <h3 id="scope-hoisting-使用"><a href="#scope-hoisting-使用" class="header-anchor">#</a> scope hoisting 使用</h3> <p>webpack mode 为 production 默认开启
必须是 ES6 语法，CJS 不支持</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    entry: {
        app: './src/app.js',
        search: './src/search.js'
    },
    output: {
        filename: '[name][chunkhash:8].js',
        path: __dirname + '/dist'
    },
    plugins: [
        new webpack.optimize.ModuleConcatenationPlugin()
    ]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_10-代码分割和动态-import"><a href="#_10-代码分割和动态-import" class="header-anchor">#</a> 10. 代码分割和动态 import</h2> <h4 id="代码分割的意义"><a href="#代码分割的意义" class="header-anchor">#</a> 代码分割的意义</h4> <p>对于大的 Web 应用来讲，将所有的代码都放在一个文件中显然是不够有效的，特别是当你的某些代码块是在某些特殊的时候才会被使用到。webpack 有一个功能就是讲你的代码库分割成 chunks （语块），当代码运行到需要他们的时候再进行加载</p> <h4 id="适用的场景"><a href="#适用的场景" class="header-anchor">#</a> 适用的场景</h4> <ul><li>抽离相同代码到一个共享块</li> <li>脚本懒加载，使得初始下载的代码更小
<img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338400%2015920403252153%20.jpg" alt="-w468"></li></ul> <h4 id="懒加载-js-脚本的方式"><a href="#懒加载-js-脚本的方式" class="header-anchor">#</a> 懒加载 JS 脚本的方式</h4> <p>CommonJS: require.ensure
ES6: 动态 import（目前还没有原生支持，需要 babel 支持）</p> <h4 id="如何使用动态-import"><a href="#如何使用动态-import" class="header-anchor">#</a> 如何使用动态 import?</h4> <ul><li>安装 babel 插件
<ul><li><code>npm install @babel/plugin-syntax-dynamic-import --save-dev</code></li></ul></li> <li>ES6: 动态 import（目前还没有原生支持，需要 babel 支持）<div class="language- line-numbers-mode"><pre class="language-text"><code>{
    &quot;plugins&quot;: [&quot;@babel/plugin-syntax-dynamic-import&quot;],
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <h4 id="代码分割的效果"><a href="#代码分割的效果" class="header-anchor">#</a> 代码分割的效果</h4> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338412%2015921075491398%20.jpg" alt="-w810"></p> <h2 id="_11-webpack-和-eslint-结合"><a href="#_11-webpack-和-eslint-结合" class="header-anchor">#</a> 11. webpack 和 ESLint 结合</h2> <h3 id="eslint-的必要性"><a href="#eslint-的必要性" class="header-anchor">#</a> ESLint 的必要性</h3> <p>2017 年年 4 ⽉月 13 ⽇日，腾讯⾼高级⼯工程师⼩小明在做充值业务时，修改了了苹果 iap ⽀支付配 置，将 JSON 配置增加了了重复的 key 。代码发布后，有⼩小部分使⽤用了了 vivo ⼿手 机的⽤用户反馈充值⻚页⾯面⽩白屏，⽆无法在 Now app 内进⾏行行充值。最后问题定位是: vivo ⼿手机使⽤用了了系统⾃自带的 webview ⽽而没有使⽤用 X5 内核，解析 JSON 时遇到 重复 key 报错，导致⻚页⾯面⽩白屏。</p> <h3 id="行业里面优秀的-eslint-规范实践"><a href="#行业里面优秀的-eslint-规范实践" class="header-anchor">#</a> 行业里面优秀的 ESLint 规范实践</h3> <h4 id="airbnb-eslint-config-airbnb、eslint-config-airbnb-base"><a href="#airbnb-eslint-config-airbnb、eslint-config-airbnb-base" class="header-anchor">#</a> Airbnb: eslint-config-airbnb、eslint-config-airbnb-base</h4> <h4 id="腾讯"><a href="#腾讯" class="header-anchor">#</a> 腾讯：</h4> <ul><li>alloyteem 团队 eslint-config-alloy <a href="https://github.com/AlloyTeam/eslint-config-alloy" target="_blank" rel="noopener noreferrer">https://github.com/AlloyTeam/eslint-config-alloy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ivweb 团队：eslint-config-ivweb <a href="https://github.com/feflow/eslint-config-ivweb" target="_blank" rel="noopener noreferrer">https://github.com/feflow/eslint-config-ivweb<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="制定团队的-eslint-规范"><a href="#制定团队的-eslint-规范" class="header-anchor">#</a> 制定团队的 ESLint 规范</h3> <ul><li>不重复造轮子，基于 eslint:recommend 配置并改进</li> <li>能够帮助发现代码错误的规则，全部开启</li> <li>帮助保持团队的代码风格统一，而不是限制开发体验
<img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338424%2015921088225309%20.jpg" alt="-w671"></li></ul> <h3 id="eslint-如何执行落地"><a href="#eslint-如何执行落地" class="header-anchor">#</a> ESLint 如何执行落地？</h3> <ul><li>和 CI/CD 系统集成</li> <li>和 webpack 集成</li></ul> <h4 id="方案一-webpack-与-ci-cd-集成"><a href="#方案一-webpack-与-ci-cd-集成" class="header-anchor">#</a> 方案一：webpack 与 CI/CD 集成</h4> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338435%2015921091532231%20.jpg" alt="-w863"></p> <h4 id="本地开发阶段增加-precommit-钩子"><a href="#本地开发阶段增加-precommit-钩子" class="header-anchor">#</a> 本地开发阶段增加 precommit 钩子</h4> <ul><li>安装 husky
<ul><li><code>npm install husky --save-dev</code></li></ul></li> <li>增加 npm script,通过 lint-staged 增量检查修改的文件</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;scripts&quot;: {
    &quot;precommit&quot;: &quot;lint-staged&quot;
},
&quot;lint-staged&quot;: {
    &quot;linters&quot;: {
        &quot;*.{js,scss}&quot;:[&quot;eslint--fix&quot;,&quot;git add&quot;]
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="方案二-webpack-与-eslint-集成"><a href="#方案二-webpack-与-eslint-集成" class="header-anchor">#</a> 方案二：webpack 与 ESLint 集成</h4> <p>使用 eslint-loader,构建时检查 JS 规范</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    module: {
        rules: [
            {
                test: /\.js$/,
                exclude: /node_modules/,
                use: [
                    &quot;babel-loader&quot;,
                    &quot;eslint-loader&quot;
                ]
            }
        ]
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_12-webpack-打包组件和基础库"><a href="#_12-webpack-打包组件和基础库" class="header-anchor">#</a> 12. webpack 打包组件和基础库</h2> <h3 id="webpack-打包库和组件"><a href="#webpack-打包库和组件" class="header-anchor">#</a> webpack 打包库和组件</h3> <p>webpack 除了可以用来打包应用，也可以用来打包 js 库
实现一个大整数加法库的打包</p> <ul><li>需要打包压缩版和非压缩版</li> <li>支持 AMD/CJS/ESM 模块引入</li></ul> <h3 id="库的目录结构和打包要求"><a href="#库的目录结构和打包要求" class="header-anchor">#</a> 库的目录结构和打包要求</h3> <p>打包输出的库名称：</p> <ul><li>未压缩版 large-number.js</li> <li>压缩版 large-number.min.js</li></ul> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338447%2015921106808310%20.jpg" alt="-w311"></p> <h3 id="支持的使用方式"><a href="#支持的使用方式" class="header-anchor">#</a> 支持的使用方式</h3> <ul><li><p>支持 ES module</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import * as largeNumber from 'large-number';
largeNumber.add('999','1');
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>支持 CJS</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>const largeNumbers = require('large-number');
largeNumber.add('999','1');
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>支持 AMD</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>require(['large-number'],function (large-number) {
    large-number.add('999','1');
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>可以直接通过 script 引入</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;!doctype html&gt; &lt;html&gt;
...
&lt;script src=&quot;https://unpkg.com/large-number&quot;&gt;&lt;/script&gt; &lt;script&gt;
// ...
// Global variable largeNumber.add('999', '1');
// Property in the window object window. largeNumber.add('999', '1'); // ...
&lt;/script&gt; &lt;/html&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <h3 id="如何将库暴露出去"><a href="#如何将库暴露出去" class="header-anchor">#</a> 如何将库暴露出去？</h3> <ul><li>library: 指定库的全局变量</li> <li>library: 支持库引入的方式</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    mode: &quot;production&quot;,
    entry: {
        &quot;large-number&quot;: &quot;./src/index.js&quot;,
        &quot;large-number.min&quot;: &quot;./src/index.js&quot;
    },
    output: {
        filename: &quot;[name].js&quot;,
        library: &quot;largeNumber&quot;,
        libraryExport: &quot;default&quot;,
        libraryTarge: &quot;umd&quot;
    }
};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="如何指对-min-压缩"><a href="#如何指对-min-压缩" class="header-anchor">#</a> 如何指对 .min 压缩</h3> <p>通过 include 设置只压缩 min.js 结尾的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = {
    mode: 'none',
    entry: {
        'large-number': './src/index.js',
        'large-number.min': './src/index.js',
    },
    output: {
        filename: '[name].js',
        library: 'largeNumber',
        libraryTarget: 'umd'
    },
    optimization: {
        minimize: true,
        minimizer: [
            new TerserPlugin({
                include: /\.min\.js$/,
            })
        ]
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="设置入口文件"><a href="#设置入口文件" class="header-anchor">#</a> 设置入口文件</h3> <h4 id="package-json-的-main-字段为-index-js"><a href="#package-json-的-main-字段为-index-js" class="header-anchor">#</a> package.json 的 main 字段为 index.js</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>if (process.env.NODE_ENV === 'production') {
    module.exports = require('./dist/large-number.min.js');
} else {
    module.exports = require('./dist/large-number.js');
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_13-webpack-实现-ssr-打包"><a href="#_13-webpack-实现-ssr-打包" class="header-anchor">#</a> 13. webpack 实现 SSR 打包</h2> <h4 id="页面打开过程"><a href="#页面打开过程" class="header-anchor">#</a> 页面打开过程</h4> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338459%2015922309368194%20.jpg" alt="-w1193"></p> <h4 id="服务端渲染-ssr-是什么"><a href="#服务端渲染-ssr-是什么" class="header-anchor">#</a> 服务端渲染（SSR）是什么？</h4> <ul><li>渲染：HTML+CSS+JS+Data -&gt; 渲染后的 HTML</li> <li>服务端：
<ul><li>所有模板等资源都存储在服务端</li> <li>内网机器拉取数据更快</li> <li>一个 HTML 返回所有数据</li></ul></li></ul> <h4 id="浏览器和服务器交互流程"><a href="#浏览器和服务器交互流程" class="header-anchor">#</a> 浏览器和服务器交互流程</h4> <div class="language- extra-class"><pre><code>![-w1178](https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338538%2015922313582041%20.jpg)
</code></pre></div><h4 id="客户端渲染-vs-服务端渲染"><a href="#客户端渲染-vs-服务端渲染" class="header-anchor">#</a> 客户端渲染 VS 服务端渲染</h4> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338471%2015922314775490%20.jpg" alt="-w1059">
总结：服务端渲染（SSR）的核心是减少请求</p> <h4 id="ssr-的优势"><a href="#ssr-的优势" class="header-anchor">#</a> SSR 的优势</h4> <ul><li>减少白屏时间</li> <li>对于 SEO 友好</li></ul> <h3 id="ssr-代码实现思路"><a href="#ssr-代码实现思路" class="header-anchor">#</a> SSR 代码实现思路</h3> <h4 id="服务端"><a href="#服务端" class="header-anchor">#</a> 服务端</h4> <ul><li>使用 react-dom/server 的 renderToString 方法将 React 组件渲染成字符串</li> <li>服务端路由返回对应的模板</li></ul> <h4 id="客户端"><a href="#客户端" class="header-anchor">#</a> 客户端</h4> <ul><li>打包出针对服务端的组件</li></ul> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338483%2015922317971142%20.jpg" alt="-w453"></p> <h3 id="webpack-ssr-打包存在的问题"><a href="#webpack-ssr-打包存在的问题" class="header-anchor">#</a> webpack ssr 打包存在的问题</h3> <h4 id="浏览器的全局变量-node-js-中没有-document-window"><a href="#浏览器的全局变量-node-js-中没有-document-window" class="header-anchor">#</a> 浏览器的全局变量（Node.js 中没有 document, window）</h4> <ul><li>组件适配：将不兼容的组件根据打包环境进行适配</li> <li>请求适配：将 fetch 或者 ajax 发送请求的写法改成 isomorphic-fetch 或者 axios</li></ul> <h4 id="样式问题-node-js-无法解析-css"><a href="#样式问题-node-js-无法解析-css" class="header-anchor">#</a> 样式问题（Node.js 无法解析 css）</h4> <ul><li>方案一：服务端打包通过 ignore-loader 忽略 CSS 的解析</li> <li>方案二：将 style-loader 替换成 isomorphic-style-loader</li></ul> <h4 id="如何解决样式不显示的问题"><a href="#如何解决样式不显示的问题" class="header-anchor">#</a> 如何解决样式不显示的问题？</h4> <ul><li>使用打包出来的浏览器端 html 为模板</li> <li>设置占位符，动态插入组件
<img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338494%2015938317402123%20.jpg" alt="-w427"></li></ul> <h4 id="首屏数据如何处理"><a href="#首屏数据如何处理" class="header-anchor">#</a> 首屏数据如何处理？</h4> <ul><li>服务端获取数据</li> <li>替换占位符
<img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338505%2015938541966729%20.jpg" alt="-w445"></li></ul> <h2 id="_14-优化构建时命令行的显示日志"><a href="#_14-优化构建时命令行的显示日志" class="header-anchor">#</a> 14. 优化构建时命令行的显示日志</h2> <h4 id="当前构建是的日志显示"><a href="#当前构建是的日志显示" class="header-anchor">#</a> 当前构建是的日志显示</h4> <p>展示一大堆日志，很多并不需要开发者关注</p> <h4 id="统计信息-stats"><a href="#统计信息-stats" class="header-anchor">#</a> 统计信息 stats</h4> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338516%2015938573704035%20.jpg" alt="-w751"></p> <h3 id="如何优化命令行的构建日志"><a href="#如何优化命令行的构建日志" class="header-anchor">#</a> 如何优化命令行的构建日志</h3> <h4 id="使用-friendly-errors-webpack-plugin"><a href="#使用-friendly-errors-webpack-plugin" class="header-anchor">#</a> 使用 friendly-errors-webpack-plugin</h4> <ul><li>success：构建成功的日志提示</li> <li>warning：构建警告的日志提示</li> <li>error：构建报错的日志提示</li></ul> <h4 id="stats-设置成-errors-only"><a href="#stats-设置成-errors-only" class="header-anchor">#</a> stats 设置成 errors-only</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>module.exports = { entry: {
app: './src/app.js',
search: './src/search.js' },
output: {
filename: '[name][chunkhash:8].js', path: __dirname + '/dist'
},
plugins: [
+ new FriendlyErrorsWebpackPlugin()
],
+ stats: 'errors-only' };
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="使用效果"><a href="#使用效果" class="header-anchor">#</a> 使用效果</h4> <p><img src="https://upload.smart-lzgz.cn/mweb/2020%2007%2019%2015951717338527%2015938579756021%20.jpg" alt="-w919"></p> <h2 id="_15-构建异常和中断处理"><a href="#_15-构建异常和中断处理" class="header-anchor">#</a> 15. 构建异常和中断处理</h2> <h4 id="如何判断构建是否成功"><a href="#如何判断构建是否成功" class="header-anchor">#</a> 如何判断构建是否成功？</h4> <p>在 CI/CD 的 pipline 或者发布系统需要知道当前构建状态
每次构建完成后输入 echo $? 获取错误码</p> <p>webpack4 之前的版本构建失败不会抛出错误码（error code）</p> <p>Node.js 中的 process.exit 规范</p> <ul><li>0 表示成功完成，回调函数中，err 为 null</li> <li>非 0 表示执行失败，回调函数中，err 不为 null，err.code 就是传给 exit 的数字</li></ul> <p>compiler 在每次构建结束后会触发 done 这个 hook
process.exit 主动处理构建报错</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>plugins: [ function() {
this.hooks.done.tap('done', (stats) =&gt; { if (stats.compilation.errors &amp;&amp;
stats.compilation.errors.length &amp;&amp; process.argv.indexOf('- -watch') == -1)
{
console.log('build error');
process.exit(1); }
}) }
]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=%E5%B7%A5%E7%A8%8B%E5%8C%96" title="标签">#工程化</a><a href="/tags/?tag=webpack" title="标签">#webpack</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/09/14, 13:59:36</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/2d4c68/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">二、基础篇：webpack 基础用法</div></a> <a href="/pages/14b103/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">四、进阶篇：编写可维护的 webpack 构建配置</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/2d4c68/" class="prev">二、基础篇：webpack 基础用法</a></span> <span class="next"><a href="/pages/14b103/">四、进阶篇：编写可维护的 webpack 构建配置</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/397a64/"><div>Hooks</div></a> <span>09-28</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/c8816b/"><div>状态更新</div></a> <span>09-26</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/4f6eee/"><div>Diff算法</div></a> <span>09-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:chstz_365@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/chst365" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2022
    <span>chst365 | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.e873eaec.js" defer></script><script src="/assets/js/2.c3598815.js" defer></script><script src="/assets/js/13.338c9daa.js" defer></script>
  </body>
</html>